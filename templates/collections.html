{% extends 'base.html' %}

{% block page_specific_style %}
  <link rel="stylesheet" href="/static/css/photo-tag.css" />
  <link rel="stylesheet" href="/static/css/edit-names.css" />
  <link rel="stylesheet" href="/static/css/filter-persons-bar.css" />
  <link rel="stylesheet" href="/static/css/face-thumbnail-tag.css" />
  <link rel="stylesheet" href="/static/css/get-sharable-link.css" />
  <link rel="stylesheet" href="/static/css/collections.css" />
{% endblock %}

{% block collections_dropdown_menu %}
  {% if not is_from_sharable_link %}
    {{ super() }}
  {% endif %}
{% endblock %}

{% block content %}
  {% if not is_from_sharable_link %}
    {{ filterpersonsbar(persons, persons, cropped_faces_dict) }}
    <div class="foto-anchor-container">
      <a href="/" class="foto-anchor"> < All collections</a>
    </div>
    <button class="share-btn foto-btn" type="button" data-collection-id="{{ collection_id }}">Get collection shareable link</button>
    <a href="/edit_persons_names/{{ collection_id }}" class="edit-names-btn"><button class="foto-btn" type="button">Edit names for collection</button></a>
  {% endif %}
  <div class="col-10 offset-1 collection__content">
    <h1 class="collection__content__title">Collection {{ collection_id }}</h1>
    <ul class="collection__content__persons-list">
    {% for person in persons %}
      <li class="content__person-item">
        <a class="thumbnail-anchor" href="/persons?person_ids[]={{ person.id }}"
        {% if person.name %}
          title="{{ person.name }}"
        {% else %}
          title="Person {{ person.id }}"
        {% endif %}
        >
          <img class="face-thumbnail" src="{{ cropped_faces_dict[person.id] }}" />
        </a>
      </li>
    {% endfor %}
    </ul>
    <div class="grid">
    {% for photo in photos %}
      <div class="grid-item">
        <a class="photo-container" href="/photos/{{ photo.id }}" title="Photo{{ photo.id }}">
          <img class="photo" src="{{ url_dict[photo.id] }}" />
          {% if photo.id in boundingbox_dict %}
            {% for person_box in boundingbox_dict[photo.id] %}
              <div
                class="tag"
                data-id="{{ photo.id }}"
                data-top="{{ person_box.face_top_percentage }}"
                data-left="{{ person_box.face_left_percentage }}"
                data-width="{{ person_box.face_width_percentage }}"
                data-height="{{ person_box.face_height_percentage}}"
              ></div>
            {% endfor %}
          {% endif %}
          <div class="faces-container">
            {% for person in photo.persons %}
              <a class="faces-container__thumbnail-anchor" href="/persons?person_ids[]={{ person.id }}"
              {% if person.name %}
                title="{{ person.name }}"
              {% else %}
                title="Person {{ person.id }}"
              {% endif %}
              >
                <img class="faces-container__face-thumbnail" src="{{ cropped_faces_dict[person.id] }}" />
              </a>
            {% endfor %}
          </div>
        </a>
      </div>
    {% endfor %}
    </div>
  </div>
{% endblock %}

{% block login_logout_button %}
  {% if not is_from_sharable_link %}
    {{ super() }}
  {% endif %}
{% endblock %}

{% block unique_link_box %}
  <div class="sharable-link__background-drop">
    <div class="sharable-link__box-container">
      <p class="sharable-link__description">
        Copy the link below to share with your friends:
      </p>
      <input type="text" class="sharable-link__textbox" value="">
      <button class="sharable-link__close-btn" type="button">Done</button>
    </div>
  </div>
{% endblock %}

{% block page_specific_scripts %}
  <script src="/static/js/masonry.pkgd.min.js"></script>
  <script src="/static/js/photo-tag.js"></script>
  <script src="/static/js/filter-persons-bar.js"></script>
  <script src="/static/js/edit-names.js"></script>
  <script src="/static/js/get-collection-sharable-link.js"></script>
  <script src="/static/js/collections.js"></script>
{% endblock %}
