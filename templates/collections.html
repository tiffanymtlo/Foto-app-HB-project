{% extends 'base.html' %}

{% block page_specific_style %}
  <link rel="stylesheet" href="/static/css/shared.css" />
  <link rel="stylesheet" href="/static/css/photo-tag.css" />
  <link rel="stylesheet" href="/static/css/edit-names.css" />
  <link rel="stylesheet" href="/static/css/filter-persons-bar.css" />
  <link rel="stylesheet" href="/static/css/face-thumbnail-tag.css" />
  <link rel="stylesheet" href="/static/css/get-sharable-link.css" />
  <link rel="stylesheet" href="/static/css/shared.css" />
{% endblock %}

{% block collections_dropdown_menu %}
  {% if not is_from_sharable_link %}
    {{ super() }}
  {% endif %}
{% endblock %}

{% block content %}
  {% if not is_from_sharable_link %}
    {{ filterpersonsbar(persons, persons, cropped_faces_dict) }}
    <a href="/">All collections</a>
  {% endif %}
  <div class="col-10 offset-1 collection__content">
    <h1>Collection {{ collection_id }}</h1>
    {% if not is_from_sharable_link %}
      <button class="share-btn foto-btn" type="button" data-collection-id="{{ collection_id }}">Get collection shareable link</button>
      <br />
      <a href="/edit_persons_names/{{ collection_id }}"><button class="edit-names-btn foto-btn" type="button">Edit names for collection</button></a>
      <br />
    {% endif %}
    <h4>Photos:</h4>
    <div class="grid">
    {% for photo in photos %}
      <div class="grid-item">
        <a class="photo-container" href="/photos/{{ photo.id }}" title="Photo{{ photo.id }}" style="width:300px">
          <img class="photo" src="{{ url_dict[photo.id] }}" />
          {% if photo.id in boundingbox_dict %}
            {% for person_box in boundingbox_dict[photo.id] %}
              <div
                class="tag"
                data-id="{{ photo.id }}"
                data-top="{{ person_box.face_top_percentage }}"
                data-left="{{ person_box.face_left_percentage }}"
                data-width="{{ person_box.face_width_percentage }}"
                data-height="{{ person_box.face_height_percentage}}"
              ></div>
            {% endfor %}
          {% endif %}
        </a>
      </div>
    {% endfor %}
  </div>

    <h4>Persons:</h4>
    <ul>
    {% for person in persons %}
      <li class="person">
        <a class="thumbnail-anchor" href="/persons?person_ids[]={{ person.id }}"
        {% if person.name %}
          title="{{ person.name }}"
        {% else %}
          title="Person {{ person.id }}"
        {% endif %}
        >
          <img class="face-thumbnail" src="{{ cropped_faces_dict[person.id] }}" />
        </a>

        {% if not is_from_sharable_link %}
          {% if person.name %}
            <div class="person__name-container">
              <div class="name-container__name">{{ person.name }}</div>
            </div>
          {% else %}
            <input class="name-field" type="text" name="name" placeholder="Person {{ person.id }}" data-personid="{{ person.id }}" />
          {% endif %}
        {% else %}
          {% if person.name %}
            <div class="person__name-container">
              <div class="name-container__name">{{ person.name }}</div>
            </div>
          {% else %}
            <div class="person__name-container">
              <div class="name-container__name">Person {{ person.id }}</div>
            </div>
          {% endif %}
        {% endif %}
      </li>
    {% endfor %}
    </ul>
  </div>
{% endblock %}

{% block login_logout_button %}
  {% if not is_from_sharable_link %}
    {{ super() }}
  {% endif %}
{% endblock %}

{% block unique_link_box %}
  <div class="sharable-link__background-drop">
    <div class="sharable-link__box-container">
      <p class="sharable-link__description">
        Copy the link below to share with your friends:
      </p>
      <input type="text" class="sharable-link__textbox" value="">
      <button class="sharable-link__close-btn" type="button">Done</button>
    </div>
  </div>
{% endblock %}

{% block page_specific_scripts %}
  <script src="/static/js/masonry.pkgd.min.js"></script>
  <script src="/static/js/photo-tag.js"></script>
  <script src="/static/js/filter-persons-bar.js"></script>
  <script src="/static/js/edit-names.js"></script>
  <script src="/static/js/get-collection-sharable-link.js"></script>
  <script src="/static/js/collections.js"></script>
{% endblock %}
